<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Poopi üíò</title>
  <style>
    :root{
      --bg1:#ffe6f2;
      --bg2:#e7f4ff;
      --card:#ffffffcc;
      --ink:#1f2330;
      --pink:#ff4d88;
      --pink2:#ff86b6;
      --shadow: 0 18px 45px rgba(20, 25, 40, .14);
      --radius: 22px;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial;
      color:var(--ink);
      min-height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      background:
        radial-gradient(1200px 700px at 10% 15%, var(--bg2), transparent 55%),
        radial-gradient(1100px 700px at 90% 10%, var(--bg1), transparent 55%),
        linear-gradient(135deg, #fff, #fff);
      overflow:hidden;
    }

    /* floating hearts background */
    .heart{
      position:absolute;
      width:14px;height:14px;
      transform: rotate(45deg);
      background: rgba(255,77,136,.28);
      border-radius: 3px;
      animation: floatUp var(--t) linear infinite;
      left: var(--x);
      bottom: -20px;
      opacity:.8;
      filter: blur(.1px);
      pointer-events:none;
    }
    .heart:before,.heart:after{
      content:"";
      position:absolute;
      width:14px;height:14px;
      background: inherit;
      border-radius:50%;
    }
    .heart:before{left:-7px;top:0}
    .heart:after{left:0;top:-7px}
    @keyframes floatUp{
      0%{ transform: translateY(0) rotate(45deg) scale(var(--s)); opacity:0}
      12%{opacity:.85}
      100%{ transform: translateY(-115vh) rotate(45deg) scale(var(--s)); opacity:0}
    }

    .wrap{
      width:min(920px, 92vw);
      position:relative;
      z-index:2;
    }
    .card{
      background:var(--card);
      border:1px solid rgba(255,255,255,.6);
      box-shadow:var(--shadow);
      border-radius:var(--radius);
      padding:26px;
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      position:relative;
      overflow:hidden;
      transform: translateZ(0);
    }
    .badge{
      display:inline-flex;
      gap:10px;
      align-items:center;
      padding:10px 14px;
      border-radius:999px;
      background: rgba(255, 255, 255, .75);
      border: 1px solid rgba(255, 77, 136, .18);
      font-size:14px;
      user-select:none;
    }
    .tiny{
      opacity:.7;
      font-size:13px;
      line-height:1.2;
    }
    .top{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      margin-bottom:12px;
    }
    .grid{
      display:grid;
      grid-template-columns: 1.12fr .88fr;
      gap:16px;
      margin-top:14px;
    }
    @media (max-width: 820px){
      .grid{grid-template-columns:1fr}
    }
    .panel{
      background: rgba(255,255,255,.72);
      border:1px solid rgba(31,35,48,.06);
      border-radius:18px;
      padding:18px;
      position:relative;
      overflow:hidden;
    }
    .title{
      font-size:32px;
      letter-spacing:-.02em;
      margin:6px 0 8px;
    }
    .subtitle{
      margin:0 0 14px;
      opacity:.86;
      line-height:1.5;
      font-size:15px;
    }
    .type{
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
      background: rgba(31,35,48,.06);
      border: 1px dashed rgba(31,35,48,.18);
      border-radius:16px;
      padding:14px;
      min-height:118px;
      line-height:1.55;
      font-size:14px;
      white-space:pre-wrap;
    }

    .ctaRow{
      display:flex;
      flex-wrap:wrap;
      gap:12px;
      margin-top:14px;
      align-items:center;
      position:relative;
      min-height:54px;
    }
    .btn{
      border:0;
      border-radius:14px;
      padding:12px 14px;
      font-weight:900;
      cursor:pointer;
      transition: transform .12s ease, box-shadow .12s ease, background .12s ease;
      user-select:none;
    }
    .btn:active{transform: translateY(1px) scale(.99)}
    .btnPrimary{
      background: linear-gradient(135deg, var(--pink), var(--pink2));
      color:white;
      box-shadow: 0 12px 24px rgba(255,77,136,.22);
    }
    .btnSneaky{
      background: rgba(31,35,48,.06);
      color: var(--ink);
      border: 1px solid rgba(31,35,48,.10);
      font-weight:850;
      box-shadow:none;
      position:absolute;
      right:0;
      top:0;
      transform: translate(0, 0);
    }

    .divider{
      height:1px;
      background: rgba(31,35,48,.08);
      margin:14px 0;
    }
    .miniList{
      margin:0;
      padding-left:18px;
      font-size:14px;
      line-height:1.6;
      opacity:.9;
    }
    .stamp{
      position:absolute;
      right:-42px;
      top:-42px;
      width:170px;
      height:170px;
      border-radius: 42px;
      background: radial-gradient(circle at 30% 30%, rgba(255,255,255,.75), rgba(255,77,136,.16));
      transform: rotate(18deg);
      pointer-events:none;
    }

    /* intro envelope */
    .intro{
      display:flex;
      align-items:center;
      justify-content:center;
      min-height: 210px;
      text-align:center;
    }
    .envelope{
      width:200px;height:132px;
      position:relative;
      cursor:pointer;
      transform: translateY(0);
      transition: transform .2s ease;
      margin: 6px auto 0;
    }
    .envelope:hover{transform: translateY(-3px)}
    .envBack{
      position:absolute; inset:0;
      border-radius:18px;
      background: rgba(255,255,255,.88);
      border: 1px solid rgba(255,77,136,.22);
      box-shadow: 0 18px 40px rgba(20,25,40,.12);
    }
    .envFlap{
      position:absolute; left:0; right:0; top:0;
      height:66px;
      background: linear-gradient(135deg, rgba(255,77,136,.22), rgba(255,127,179,.12));
      clip-path: polygon(0 0, 100% 0, 50% 100%);
      border-top-left-radius:18px;
      border-top-right-radius:18px;
    }
    .envNote{
      position:absolute;
      left:14px; right:14px; bottom:14px;
      height:64px;
      border-radius:14px;
      background: rgba(255, 231, 241, .9);
      border: 1px solid rgba(255,77,136,.18);
      display:flex;
      align-items:center;
      justify-content:center;
      font-weight:1000;
      letter-spacing:-.01em;
    }

    /* celebration screen */
    .overlay{
      position:fixed; inset:0;
      display:none;
      align-items:center;
      justify-content:center;
      padding:18px;
      z-index:10;
      background: rgba(15,18,25,.55);
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
    }
    .overlay.show{display:flex}
    .modal{
      width:min(780px, 94vw);
      background: rgba(255,255,255,.95);
      border-radius:22px;
      box-shadow: 0 28px 70px rgba(0,0,0,.25);
      padding:20px;
      position:relative;
      overflow:hidden;
    }
    .close{
      position:absolute;
      right:14px; top:14px;
      border:0; cursor:pointer;
      width:38px;height:38px;border-radius:12px;
      background: rgba(31,35,48,.06);
      font-weight:1000;
    }

    /* Meme grid (cleaner) */
    .memeGrid{
      display:grid;
      grid-template-columns:1fr 1fr;
      gap:12px;
      margin-top:12px;
    }
    @media (max-width: 780px){
      .memeGrid{grid-template-columns:1fr}
    }
    .memeCard{
      border-radius:18px;
      padding:14px;
      background: rgba(31,35,48,.04);
      border: 1px solid rgba(31,35,48,.08);
      line-height:1.4;
    }
    .memeTitle{
      font-weight:1000;
      margin:0 0 6px;
      letter-spacing:-.01em;
    }
    .mono{
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
      opacity:.9;
      white-space:pre-wrap;
      margin:0;
      font-size:13px;
    }
    .bigBadge{
      display:inline-flex;
      gap:10px;
      align-items:center;
      padding:10px 14px;
      border-radius:999px;
      background: rgba(255, 77, 136, .10);
      border: 1px solid rgba(255, 77, 136, .22);
      font-weight:1000;
      margin-bottom:10px;
    }
    .progress{
      height:10px;
      border-radius:999px;
      background: rgba(31,35,48,.08);
      overflow:hidden;
      border: 1px solid rgba(31,35,48,.08);
    }
    .bar{
      height:100%;
      width:0%;
      background: linear-gradient(135deg, var(--pink), var(--pink2));
      border-radius:999px;
      transition: width .8s ease;
    }

    /* Toast */
    .toastWrap{
      position:fixed;
      left:50%;
      bottom:18px;
      transform: translateX(-50%);
      z-index:11;
      display:flex;
      flex-direction:column;
      gap:10px;
      pointer-events:none;
    }
    .toast{
      pointer-events:none;
      background: rgba(255,255,255,.95);
      border: 1px solid rgba(31,35,48,.10);
      border-radius:999px;
      padding:10px 14px;
      box-shadow: 0 18px 40px rgba(0,0,0,.12);
      font-weight:900;
      opacity:0;
      transform: translateY(8px);
      animation: popToast 1.6s ease forwards;
      max-width: 92vw;
      text-align:center;
    }
    @keyframes popToast{
      0%{opacity:0; transform: translateY(10px) scale(.98)}
      15%{opacity:1; transform: translateY(0) scale(1)}
      85%{opacity:1; transform: translateY(0) scale(1)}
      100%{opacity:0; transform: translateY(10px) scale(.98)}
    }

    canvas#confetti{
      position:fixed;
      inset:0;
      pointer-events:none;
      z-index:9;
      display:none;
    }
    canvas#confetti.show{display:block}

    /* tiny shake */
    .shake{
      animation: shake .35s ease;
    }
    @keyframes shake{
      0%{transform: translateX(0)}
      20%{transform: translateX(-6px)}
      40%{transform: translateX(6px)}
      60%{transform: translateX(-4px)}
      80%{transform: translateX(4px)}
      100%{transform: translateX(0)}
    }

    /* ===== Date Picker + extra interactivity ===== */
    .planGrid{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:10px;
      margin-top:10px;
    }
    @media (max-width: 780px){
      .planGrid{ grid-template-columns:1fr; }
    }
    .planBtn{
      border:0;
      border-radius:16px;
      padding:12px 12px;
      cursor:pointer;
      font-weight:950;
      background: rgba(255,255,255,.9);
      border: 1px solid rgba(31,35,48,.10);
      text-align:left;
      transition: transform .12s ease, box-shadow .12s ease;
    }
    .planBtn:hover{ transform: translateY(-1px); box-shadow: 0 16px 34px rgba(0,0,0,.08); }
    .planBtn:active{ transform: translateY(1px) scale(.99); }

    .planBtn.selected{
      border: 1px solid rgba(255,77,136,.45);
      box-shadow: 0 18px 42px rgba(255,77,136,.18);
      background: linear-gradient(135deg, rgba(255,77,136,.10), rgba(255,134,182,.08), rgba(255,255,255,.92));
    }

    .planResult{
      margin-top:10px;
      border-radius:16px;
      padding:12px;
      background: rgba(31,35,48,.04);
      border: 1px solid rgba(31,35,48,.08);
      font-weight:900;
      line-height:1.45;
    }

    .approvedStamp{
      position:absolute;
      right:14px;
      bottom:14px;
      padding:10px 12px;
      border-radius:999px;
      background: rgba(255,77,136,.12);
      border:1px solid rgba(255,77,136,.22);
      font-weight:1000;
      transform: scale(.92);
      opacity:0;
      pointer-events:none;
    }
    .approvedStamp.show{
      opacity:1;
      transform: scale(1);
      animation: popStamp .35s ease;
    }
    @keyframes popStamp{
      0%{ transform: scale(.85) rotate(-3deg); }
      60%{ transform: scale(1.03) rotate(2deg); }
      100%{ transform: scale(1) rotate(0deg); }
    }

    .clickable{
      cursor:pointer;
      user-select:none;
    }

    /* ===== KISS POP (when YES is clicked) ===== */
    .kissPop{
      position:fixed;
      left:50%;
      top:42%;
      transform: translate(-50%, -50%) scale(.6);
      font-size: 92px;
      z-index: 12;
      pointer-events:none;
      filter: drop-shadow(0 16px 26px rgba(0,0,0,.20));
      opacity:0;
      animation: kissPop 1.05s ease forwards;
    }
    @keyframes kissPop{
      0%{opacity:0; transform: translate(-50%,-50%) scale(.6) rotate(-8deg);}
      18%{opacity:1; transform: translate(-50%,-50%) scale(1.15) rotate(8deg);}
      55%{opacity:1; transform: translate(-50%,-50%) scale(1.0) rotate(0deg);}
      100%{opacity:0; transform: translate(-50%,-65%) scale(.95) rotate(0deg);}
    }
    .kissFloat{
      position:fixed;
      left:50%;
      top:55%;
      transform: translate(-50%,-50%);
      font-size: 34px;
      z-index: 12;
      pointer-events:none;
      opacity:0;
      animation: kissFloat 1.2s ease forwards;
      filter: drop-shadow(0 12px 18px rgba(0,0,0,.18));
    }
    @keyframes kissFloat{
      0%{opacity:0; transform: translate(-50%,-50%) scale(.8);}
      18%{opacity:1; transform: translate(calc(-50% + var(--dx)), calc(-50% + var(--dy))) scale(1.1);}
      100%{opacity:0; transform: translate(calc(-50% + var(--dx)), calc(-50% - 80px + var(--dy))) scale(.95);}
    }
  </style>
</head>
<body>
  <canvas id="confetti"></canvas>
  <div id="hearts"></div>
  <div class="toastWrap" id="toastWrap"></div>

  <div class="wrap">
    <div class="card" id="card">
      <div class="stamp" aria-hidden="true"></div>

      <div class="top">
        <div class="badge">üíå <b id="pillText">Poopi ‚Äî open the envelope</b></div>
        <div class="tiny" id="dateText"></div>
      </div>

      <!-- INTRO -->
      <div id="intro" class="intro">
        <div>
          <div class="envelope" id="openEnv" role="button" tabindex="0" aria-label="Open letter">
            <div class="envBack"></div>
            <div class="envFlap"></div>
            <div class="envNote">Open me, Poopi ü•∫</div>
          </div>
          <div class="tiny" style="margin-top:12px;opacity:.8">
            (warning: contains rizz, chaos, and a very unserious boy)
          </div>
        </div>
      </div>

      <!-- MAIN -->
      <div id="main" style="display:none">
        <div class="grid">
          <div class="panel">
            <div class="title">HAI POOPEROONI üíò</div>
            <p class="subtitle">
              I made a website because texting this felt too normal.
              Also‚Ä¶ I felt incredibly romantic for my pretty girl. üòå
            </p>

            <div class="type" id="typebox"></div>

            <div class="ctaRow" id="ctaRow">
              <button class="btn btnPrimary" id="yesBtn">YES. I‚Äôm your Valentine üíò</button>
              <!-- NOPE comes back, but every attempt triggers a surprise -->
              <button class="btn btnSneaky" id="noBtn">Nope üòº</button>
            </div>

            <div class="divider"></div>
            <ul class="miniList">
              <li>If you try ‚ÄúNope‚Äù‚Ä¶ you‚Äôll unlock so so so many surprises</li>
              <li>If you click ‚ÄúYES‚Äù‚Ä¶ you‚Äôll unlock my entire heart</li>
              <li>I‚Äôm watching you. üòà</li>
            </ul>
          </div>

          <div class="panel">
            <div class="title" style="font-size:22px;margin-top:2px">Girlfrien facts (scientifically true)</div>
            <p class="subtitle" style="margin-bottom:10px">
              Cause I know my rizz makes you smile.
            </p>
            <ul class="miniList" id="facts">
              <li>If you were a stock, I‚Äôm going all-in. No stop loss. üòà</li>
              <li>Are your legs tired? Because you‚Äôve been running through my head all day. üíò</li>
              <li>I‚Äôm not really into watching sunsets‚Ä¶ but I‚Äôd watch you glow all day. üòà</li>
              <li>You must be ice cream because I can‚Äôt get enough of you. üíò</li>
              <li>Devi = my favorite problem I never want solved.</li>
            </ul>
            <div class="divider"></div>
            <div class="tiny">
              PS: If you‚Äôre smiling right now, don‚Äôt lie to me. I can feel it.
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- CELEBRATION MODAL -->
  <div class="overlay" id="overlay">
    <div class="modal">
      <button class="close" id="closeModal">‚úï</button>

      <div class="bigBadge" id="badgeLine">üèÜ Achievement Unlocked: Poopi said YES</div>
      <h2 id="memeHeader" style="margin:6px 0 8px; letter-spacing:-.02em;">POV: you clicked YES üò≠üíò</h2>

      <div class="memeCard" style="margin-bottom:12px;">
        <p class="memeTitle" style="margin:0 0 8px;">Live reaction:</p>
        <pre class="mono clickable" id="asciiFace">Aakash.exe has stopped working
Reason: POOPI TOO CUTE
Attempting reboot... ‚úÖ</pre>
        <div style="margin-top:12px;">
          <div class="tiny" style="margin-bottom:6px;opacity:.75">Downloading kisses‚Ä¶</div>
          <div class="progress"><div class="bar" id="bar"></div></div>
        </div>
      </div>

      <div class="memeGrid" id="memeGrid"></div>

      <!-- Saturday LDR date picker -->
      <div class="memeCard" id="dateCard" style="position:relative;">
        <div class="memeTitle">Alright my Girlfrien‚Ä¶ what Saturday LDR date we doing? üòº</div>

        <div class="planGrid">
          <button class="planBtn" data-plan="dinner">üçú Dinner date ‚Äî same time + video call (we eat like NPCs together)</button>
          <button class="planBtn" data-plan="movie">üé¨ Movie night ‚Äî watch-party + live commentary (aka you roasting my taste)</button>
          <button class="planBtn" data-plan="games">üéÆ Games night ‚Äî Skribbl/Gartic + ‚Äúwinner gets kisses‚Äù</button>
          <button class="planBtn" data-plan="playlist">üéß Playlist date ‚Äî swap songs + 20 questions (dangerous rizz edition)</button>
          <button class="planBtn" data-plan="roulette">üé≤ Surprise me ‚Äî roulette picks for you (and you can‚Äôt complain)</button>
        </div>

        <div class="planResult" id="planResult">
          Pick one, Poopi. I‚Äôll plan it and you just show up cute. ‚úÖ
        </div>

        <div class="approvedStamp" id="poopiStamp">POOPI APPROVED ‚úÖ</div>
      </div>

      <div class="divider"></div>
      <p class="tiny" style="margin:0;opacity:.75">
        Tap outside to close. Then click YES again because it‚Äôs satisfying.
      </p>
    </div>
  </div>

  <script>
    // Names
    const HER_NAME = "Devi";
    const NICKNAME = "Poopi";
    const YOUR_NAME = "Aakash";

    // Date
    document.getElementById("dateText").textContent = new Date().toLocaleDateString(undefined, {
      weekday:'long', year:'numeric', month:'long', day:'numeric'
    });

    // Background hearts
    const hearts = document.getElementById("hearts");
    for(let i=0;i<28;i++){
      const h = document.createElement("div");
      h.className="heart";
      h.style.setProperty("--x", Math.floor(Math.random()*100)+"vw");
      h.style.setProperty("--t", (6+Math.random()*8).toFixed(2)+"s");
      h.style.setProperty("--s", (0.6+Math.random()*1.4).toFixed(2));
      h.style.background = `rgba(255,77,136,${(0.16+Math.random()*0.35).toFixed(2)})`;
      h.style.animationDelay = (-Math.random()*10).toFixed(2)+"s";
      hearts.appendChild(h);
    }

    // Toasts
    const toastWrap = document.getElementById("toastWrap");
    function toast(text){
      const t = document.createElement("div");
      t.className = "toast";
      t.textContent = text;
      toastWrap.appendChild(t);
      setTimeout(()=> t.remove(), 1700);
    }

    // Intro -> main
    const intro = document.getElementById("intro");
    const main = document.getElementById("main");
    const openEnv = document.getElementById("openEnv");
    const pillText = document.getElementById("pillText");

    function openLetter(){
      intro.style.display="none";
      main.style.display="block";
      pillText.textContent = `${NICKNAME}, welcome to the rizz department`;
      startTyping();
    }
    openEnv.addEventListener("click", openLetter);
    openEnv.addEventListener("keydown", (e)=>{ if(e.key==="Enter"||e.key===" ") openLetter(); });

    // Typewriter (your vibe)
    const typebox = document.getElementById("typebox");
    const messageLines = [
      `Dearest ${NICKNAME},`,
      ``,
      `I have an announcement:`,
      `‚Ä¢ you‚Äôre MY prettiest lil princess`,
      `‚Ä¢ I miss you so frickin much (screw ldr)`,
      `‚Ä¢ I made a website cause i couldn't stop thinking about u`,
      ``,
      `So ${HER_NAME}‚Ä¶ be my Valentine? üíò`,
      ``,
      `Don't even try pressing nope (you can try üòâ)`,
      `because you‚Äôre way too adorable to not be mine.`,
      ``,
      `‚Äî YOUR MANZIE (your favorite headache)`
    ];

    let typing = false;
    function startTyping(){
      if(typing) return;
      typing = true;
      typebox.textContent = "";
      const full = messageLines.join("\n");
      let i=0;
      const speed = 16;
      const tick = () => {
        typebox.textContent = full.slice(0,i);
        i++;
        if(i<=full.length) setTimeout(tick, speed);
        else typing=false;
      };
      tick();
    }

    // Confetti + Fireworks share the same canvas
    const canvas = document.getElementById("confetti");
    const ctx = canvas.getContext("2d");
    function resize(){
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
    }
    window.addEventListener("resize", resize);
    resize();

    // Confetti
    let confettiPieces = [];
    function fireConfetti(){
      canvas.classList.add("show");
      confettiPieces = [];
      const count = 190;

      for(let i=0;i<count;i++){
        confettiPieces.push({
          x: Math.random()*canvas.width,
          y: -20 - Math.random()*canvas.height*0.2,
          r: 3 + Math.random()*4,
          vx: -2 + Math.random()*4,
          vy: 2 + Math.random()*5,
          rot: Math.random()*Math.PI,
          vr: -0.12 + Math.random()*0.24,
          life: 0,
          max: 95 + Math.random()*70,
          hue: 320 + Math.random()*60
        });
      }

      let frame = 0;
      const draw = ()=>{
        frame++;
        ctx.clearRect(0,0,canvas.width,canvas.height);

        for(const p of confettiPieces){
          p.x += p.vx;
          p.y += p.vy;
          p.vy += 0.03;
          p.rot += p.vr;
          p.life++;

          ctx.save();
          ctx.translate(p.x, p.y);
          ctx.rotate(p.rot);
          ctx.globalAlpha = Math.max(0, 1 - (p.life/p.max));
          ctx.fillStyle = `hsla(${p.hue}, 90%, 70%, 1)`;
          ctx.fillRect(-p.r, -p.r, p.r*2.6, p.r*1.5);
          ctx.restore();
        }

        confettiPieces = confettiPieces.filter(p=>p.life<p.max && p.y < canvas.height+40);
        if(confettiPieces.length && frame < 280){
          requestAnimationFrame(draw);
        }else{
          canvas.classList.remove("show");
        }
      };
      draw();
    }

    // Fireworks (for date selection)
    let fwParticles = [];
    let fwRunning = false;
    function fireFireworks(){
      if(fwRunning) return;
      fwRunning = true;

      canvas.classList.add("show");
      fwParticles = [];
      let frames = 0;

      const burst = ()=>{
        const x = canvas.width*(0.12 + Math.random()*0.76);
        const y = canvas.height*(0.08 + Math.random()*0.45);
        const hue = 320 + Math.random()*60;
        const n = 60 + Math.floor(Math.random()*22);

        for(let i=0;i<n;i++){
          const a = Math.random()*Math.PI*2;
          const sp = 1.8 + Math.random()*4.2;
          fwParticles.push({
            x,y,
            vx: Math.cos(a)*sp,
            vy: Math.sin(a)*sp,
            life: 0,
            max: 60 + Math.random()*35,
            hue
          });
        }
      };

      const draw = ()=>{
        frames++;
        ctx.clearRect(0,0,canvas.width,canvas.height);

        if(frames % 10 === 0 && frames < 120) burst();

        for(const p of fwParticles){
          p.x += p.vx;
          p.y += p.vy;
          p.vy += 0.06;      // gravity
          p.vx *= 0.985;     // drag
          p.vy *= 0.985;
          p.life++;

          const alpha = Math.max(0, 1 - p.life/p.max);
          ctx.save();
          ctx.globalAlpha = alpha;
          ctx.fillStyle = `hsla(${p.hue}, 95%, 70%, 1)`;
          ctx.beginPath();
          ctx.arc(p.x, p.y, 2.2, 0, Math.PI*2);
          ctx.fill();
          ctx.restore();
        }

        fwParticles = fwParticles.filter(p => p.life < p.max);

        if((fwParticles.length > 0 || frames < 140) && frames < 220){
          requestAnimationFrame(draw);
        }else{
          canvas.classList.remove("show");
          fwRunning = false;
        }
      };

      draw();
    }

    // Kiss pop (when YES is clicked)
    function showKiss(){
      const k = document.createElement("div");
      k.className = "kissPop";
      k.textContent = "üíã";
      document.body.appendChild(k);

      for(let i=0;i<6;i++){
        const f = document.createElement("div");
        f.className = "kissFloat";
        f.textContent = (Math.random() < 0.5) ? "üíã" : "üòò";
        f.style.setProperty("--dx", `${(-110 + Math.random()*220).toFixed(0)}px`);
        f.style.setProperty("--dy", `${(-40 + Math.random()*80).toFixed(0)}px`);
        f.style.animationDelay = `${(i*0.04).toFixed(2)}s`;
        document.body.appendChild(f);
        setTimeout(()=> f.remove(), 1400);
      }

      setTimeout(()=> k.remove(), 1150);
    }

    // Celebration modal (memes)
    const overlay = document.getElementById("overlay");
    const closeModal = document.getElementById("closeModal");
    const memeGrid = document.getElementById("memeGrid");
    const memeHeader = document.getElementById("memeHeader");
    const asciiFace = document.getElementById("asciiFace");
    const badgeLine = document.getElementById("badgeLine");
    const bar = document.getElementById("bar");
    const card = document.getElementById("card");

    function showModal(){ overlay.classList.add("show"); }
    function hideModal(){ overlay.classList.remove("show"); }
    closeModal.addEventListener("click", hideModal);
    overlay.addEventListener("click", (e)=>{ if(e.target === overlay) hideModal(); });

    const memeHeaders = [
      "POV: you clicked YES üò≠üíò",
      "Breaking news: Poopi is mine (respectfully) üóûÔ∏è",
      "Today‚Äôs forecast: 100% kisses, 0% arguments ‚òÄÔ∏è",
      "Live footage of Aakash after YES: üßç‚Äç‚ôÇÔ∏è‚û°Ô∏èü´†"
    ];

    const asciiOptions = [
`System Log:
> user: ${NICKNAME}
> action: clicked YES
> result: Aakash smiling like an idiot ‚úÖ`,
`ALERT üö®
Status: MINE FOREVER üíÄ`,
`Girlfrien UPDATE:
‚Ä¢ adorable ‚úÖ
‚Ä¢ dangerously gorgeous ‚úÖ
‚Ä¢ my valentine ‚úÖ
Conclusion: me = happiest boi in the universe.`
    ];

    // CLEANER MEMES:
    // - Removed: "Rizz report"
    // - Removed: `${NICKNAME} clicking ‚ÄúNope‚Äù`
    // Also: show only 2 boxes to reduce mess.
    const memeCards = [
      {t:"Me pretending I‚Äôm chill", b:"üòê\n(inside: screaming + blushing + doing backflips)"},
      {t:"Distance rn", b:"üìç India\nüìç Me\nüß≤ still pulling you closer"},
      {t:"Relationship status", b:"Soft launch ‚úÖ\nHard launch ‚úÖ\nPoopi officially secured ‚úÖ"},
      {t:"Kiss delivery ETA", b:"Calculating‚Ä¶\nRoute: straight to your forehead\nETA: ASAP üíã"}
    ];

    function buildMemes(){
      memeGrid.innerHTML = "";

      // pick 2 random boxes (cleaner layout)
      const pool = [...memeCards].sort(()=>Math.random()-0.5).slice(0,2);
      pool.forEach(c=>{
        const el = document.createElement("div");
        el.className = "memeCard";
        el.innerHTML = `
          <div class="memeTitle">${c.t}</div>
          <pre class="mono">${c.b}</pre>
        `;
        memeGrid.appendChild(el);
      });

      memeHeader.textContent = memeHeaders[Math.floor(Math.random()*memeHeaders.length)];
      asciiFace.textContent = asciiOptions[Math.floor(Math.random()*asciiOptions.length)];
      badgeLine.textContent = `üèÜ Achievement Unlocked: ${NICKNAME} said YES`;
      bar.style.width = "0%";
      setTimeout(()=> bar.style.width = "100%", 120);

      resetDatePicker();
    }

    document.getElementById("yesBtn").addEventListener("click", ()=>{
      showKiss();           // üíã on screen
      fireConfetti();       // confetti celebration
      buildMemes();
      showModal();
      toast("OKAYYYYY POOPI üíòüíòüíò");
    });

    // NOPE surprises
    const noBtn = document.getElementById("noBtn");
    const ctaRow = document.getElementById("ctaRow");

    const nopeToasts = [
      "Nope clicked? lol your finger slipped üò≠",
      "Try again Poopi üòº (you won‚Äôt)",
      "Access denied: too cute to reject ‚ùå",
      "Nice attempt. I‚Äôm still your valentine btw.",
      "You clicked Nope and got‚Ä¶ NOTHING. Except love.",
      "This button is for comedy purposes only."
    ];

    function teleportNope(){
      const rect = ctaRow.getBoundingClientRect();
      const maxX = Math.max(0, rect.width - noBtn.offsetWidth);
      const maxY = 36;
      const x = Math.random() * maxX;
      const y = Math.random() * maxY;
      noBtn.style.transform = `translate(${x}px, ${y}px) rotate(${(-6 + Math.random()*12).toFixed(1)}deg)`;
    }

    function surprise(){
      const roll = Math.floor(Math.random()*6);
      if(roll === 0){
        toast(nopeToasts[Math.floor(Math.random()*nopeToasts.length)]);
        teleportNope();
      } else if(roll === 1){
        toast("Plot twist: you‚Äôre my girlfrien üíò");
        card.classList.add("shake");
        setTimeout(()=> card.classList.remove("shake"), 380);
        teleportNope();
      } else if(roll === 2){
        toast("üíã *forehead kiss applied*");
        fireMiniHearts(8);
        teleportNope();
      } else if(roll === 3){
        toast("Loading: Poopi‚Äôs YES‚Ä¶ 99% ‚úÖ");
        noBtn.textContent = "Nope üòº (sus)";
        teleportNope();
      } else if(roll === 4){
        toast("You thought you‚Äôd click Nope? I thought you were smart üò≠");
        fireMiniHearts(10);
        teleportNope();
      } else {
        toast("Fine. Click it. (It still won‚Äôt do anything) üòå");
        teleportNope();
      }

      clearTimeout(noBtn._resetTimer);
      noBtn._resetTimer = setTimeout(()=>{
        noBtn.textContent = "Nope üòº";
        noBtn.style.transform = "translate(0,0) rotate(0deg)";
      }, 900);
    }

    noBtn.addEventListener("pointerdown", (e)=>{
      e.preventDefault();
      surprise();
    });

    noBtn.addEventListener("mouseenter", ()=>{
      if (Math.random() < 0.55) surprise();
    });

    function fireMiniHearts(n=10){
      for(let i=0;i<n;i++){
        const h = document.createElement("div");
        h.className="heart";
        h.style.setProperty("--x", Math.floor(30+Math.random()*40)+"vw");
        h.style.setProperty("--t", (2.8+Math.random()*2.2).toFixed(2)+"s");
        h.style.setProperty("--s", (0.9+Math.random()*1.2).toFixed(2));
        h.style.background = `rgba(255,77,136,${(0.25+Math.random()*0.35).toFixed(2)})`;
        h.style.animationDelay = "0s";
        hearts.appendChild(h);
        setTimeout(()=> h.remove(), 3400);
      }
    }

    // Click ASCII for extra reactions
    let asciiIndex = 0;
    asciiFace.addEventListener("click", ()=>{
      asciiIndex = (asciiIndex + 1) % asciiOptions.length;
      asciiFace.textContent = asciiOptions[asciiIndex];
      toast("STOP POKING ME üò≠");
      fireMiniHearts(6);
    });

    // ===== Date picker logic =====
    const planResult = document.getElementById("planResult");
    const poopiStamp = document.getElementById("poopiStamp");
    const planBtns = Array.from(document.querySelectorAll(".planBtn"));

    const planData = {
      dinner: {
        title: "üçú Dinner date",
        msg:
`LOCKED: Dinner date (Saturday) ‚úÖ
Rules:
‚Ä¢ same time, video call on
‚Ä¢ you pick your food, I pick mine
‚Ä¢ after dinner: 10 mins ‚Äútell me everything‚Äù + 10 mins rizz
Outcome: you smiling (mandatory)`
      },
      movie: {
        title: "üé¨ Movie night",
        msg:
`LOCKED: Movie night (Saturday) ‚úÖ
Plan:
‚Ä¢ we choose 1 movie / 2 episodes
‚Ä¢ you roast my choices ON MIC
‚Ä¢ intermission: kiss break üíã`
      },
      games: {
        title: "üéÆ Games night",
        msg:
`LOCKED: Games night (Saturday) ‚úÖ
Games:
‚Ä¢ Skribbl / Gartic / Ludo / Chess
Bet:
‚Ä¢ winner gets kisses
‚Ä¢ loser still gets kisses (i‚Äôm not evil)`
      },
      playlist: {
        title: "üéß Playlist + questions",
        msg:
`LOCKED: Playlist date (Saturday) ‚úÖ
Plan:
‚Ä¢ swap 3 songs each
‚Ä¢ 20 questions (dangerous edition)
‚Ä¢ last question: ‚Äúwhat do you want from me this week?‚Äù`
      }
    };

    function resetDatePicker(){
      if(!planResult) return;
      planBtns.forEach(b=> b.classList.remove("selected"));
      poopiStamp?.classList.remove("show");
      planResult.textContent = "Pick one, Poopi. I‚Äôll plan it and you just show up cute. ‚úÖ";
    }

    function choosePlan(key){
      planBtns.forEach(b=> b.classList.remove("selected"));
      const btn = planBtns.find(b => b.dataset.plan === key);
      if(btn) btn.classList.add("selected");

      poopiStamp?.classList.add("show");
      fireMiniHearts(14);
      fireFireworks(); // üéÜ FIREWORKS when she chooses a date
      toast("OKAY GIRLFRIEN ‚úÖ");
      planResult.textContent = planData[key].msg;
    }

    function roulettePick(){
      const keys = ["dinner","movie","games","playlist"];
      toast("Roulette spinning‚Ä¶ üé≤");
      setTimeout(()=>{
        const pick = keys[Math.floor(Math.random()*keys.length)];
        toast("Chosen: " + planData[pick].title);
        choosePlan(pick);
      }, 650);
    }

    planBtns.forEach(btn=>{
      btn.addEventListener("click", ()=>{
        const key = btn.dataset.plan;
        if(key === "roulette") roulettePick();
        else choosePlan(key);
      });
    });
  </script>
</body>
</html>
